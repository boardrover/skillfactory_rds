# Проект 2. Разведывательный анализ данных

## Описание проекта

Отследить влияние условий жизни учащихся в возрасте от 15 до 22 лет на их успеваемость по математике, чтобы на ранней стадии выявлять студентов, находящихся в группе риска.

## Задача

Провести разведывательный анализ данных и составить отчёт по его результатам. 

## Описание датасета

Исходные данные: [stud_math.csv](stud_math.csv)

1. `school` — аббревиатура школы, в которой учится ученик
1. `sex` — пол ученика ('F' - женский, 'M' - мужской)
1. `age` — возраст ученика (от 15 до 22)
1. `address` — тип адреса ученика ('U' - городской, 'R' - за городом)
1. `famsize` — размер семьи('LE3' <= 3, 'GT3' >3)
1. `Pstatus` — статус совместного жилья родителей ('T' - живут вместе 'A' - раздельно)
1. `Medu` — образование матери (0 - нет, 1 - 4 класса, 2 - 5-9 классы, 3 - среднее специальное или 11 классов, 4 - высшее)
1. `Fedu` — образование отца (0 - нет, 1 - 4 класса, 2 - 5-9 классы, 3 - среднее специальное или 11 классов, 4 - высшее)
1. `Mjob` — работа матери ('teacher' - учитель, 'health' - сфера здравоохранения, 'services' - гос служба, 'at_home' - не работает, 'other' - другое)
1. `Fjob` — работа отца ('teacher' - учитель, 'health' - сфера здравоохранения, 'services' - гос служба, 'at_home' - не работает, 'other' - другое)
1. `reason` — причина выбора школы ('home' - близость к дому, 'reputation' - репутация школы, 'course' - образовательная программа, 'other' - другое)
1. `guardian` — опекун ('mother' - мать, 'father' - отец, 'other' - другое)
1. `traveltime` — время в пути до школы (1 - <15 мин., 2 - 15-30 мин., 3 - 30-60 мин., 4 - >60 мин.)
1. `studytime` — время на учёбу помимо школы в неделю (1 - <2 часов, 2 - 2-5 часов, 3 - 5-10 часов, 4 - >10 часов)
1. `failures` — количество внеучебных неудач (n, если 1<=n<=3, иначе 0)
1. `schoolsup` — дополнительная образовательная поддержка (yes или no)
1. `famsup` — семейная образовательная поддержка (yes или no)
1. `paid` — дополнительные платные занятия по математике (yes или no)
1. `activities` — дополнительные внеучебные занятия (yes или no)
1. `nursery` — посещал детский сад (yes или no)
1. `higher` — хочет получить высшее образование (yes или no)
1. `internet` — наличие интернета дома (yes или no)
1. `romantic` — в романтических отношениях (yes или no)
1. `famrel` — семейные отношения (от 1 - очень плохо до 5 - очень хорошо)
1. `freetime` — свободное время после школы (от 1 - очень мало до 5 - очень мого)
1. `goout` — проведение времени с друзьями (от 1 - очень мало до 5 - очень много)
1. `health` — текущее состояние здоровья (от 1 - очень плохо до 5 - очень хорошо)
1. `absences` — количество пропущенных занятий
1. `score` — баллы по госэкзамену по математике

## План исследования

1. Провести первичную обработку данных
1. Устранить выбросы в числовых полях
1. Оценить количество уникальных значений для номинативных переменных
1. Преобразовать данные (при необходимости)
1. Провести корреляционный анализ количественных переменных
1. Отобрать не коррелирующие переменные
1. Проанализировать номинативные переменные, устранить те, которые не влияют на предсказываемую величину
1. Сделать выводы относительно качества данных

### Первичная обработка данных

#### Соответствие структуры датасета

В исходном датасете имелся лишний столбец - `studytime, granular`, отсутствующий в задаче.

#### Чистка записей с пропусками

Общее кол-во записей: 395
Кол-во записей после чистки пропущенных полей: 97

Столбцы без пропущенных данных:

* `school`
* `sex`
* `age`

Столбцы с пропущенными данными:

* `address` - 17 пропусков
* `famsize` - 27 пропусков
* `Pstatus` - 45 пропусков
* `Medu` - 3 пропусков
* `Fedu` - 24 пропусков
* `Mjob` - 19 пропусков
* `Fjob` - 36 пропусков
* `reason` - 17 пропусков
* `guardian` - 31 пропусков
* `traveltime` - 28 пропусков
* `studytime` - 7 пропусков
* `failures` - 22 пропусков
* `schoolsup` - 9 пропусков
* `famsup` - 39 пропусков
* `paid` - 40 пропусков
* `activities` - 14 пропусков
* `nursery` - 16 пропусков
* `higher` - 20 пропусков
* `internet` - 34 пропусков
* `romantic` - 31 пропусков
* `famrel` - 27 пропусков
* `freetime` - 11 пропусков
* `goout` - 8 пропусков
* `health` - 15 пропусков
* `absences` - 12 пропусков
* `score` - 6 пропусков

#### Валидация значений

Для проведения валидации был построен датафрейм с правилами валидации по каждому полю датасета. Поскольку часть полей не предполагают валидации (поля `absences` и `score` не имеют требований по валидности), добавлен дополнительный признак необходимости проведения операции проверки (`validation`).
Значения, провалившие валидацию, заменяются пропусками. После чего проводится повторная чистка записей с пропущенными значениями.

Повторная чистка (вместо проведения валидации до чистки пропусков) проведена для того, чтобы можно было пошагово понять, сколько записей провалили валидацию и не спутать их с кол-вом изначально пропущенных данных.

По итогам проверки ошибок валидации не выявлено - все записи с непустыми значениями содержат валидные данные.

### Устранение выбросов в числовых полях

Поля, содержащие выбросы:

* `age` - 1 выброс
* `absences` - 3 выброса
* `score` - 7 выбросов
---
* `traveltime` - 1 выброс
* `failures` - 19 выбросов
* `famrel` - 47 выбросов
* `freetime` - 8 выбросов

Поскольку выбросы для категориальных параметров неочевидны с точки зрения здравого смысла, было проведено два эксперимента:

1. Исключены все выбросы во всех числовых полях согласно формальным правилам (все поля в списке выше)
После устранения выбросов осталось записей: 61
1. Исключены выбросы только в числовых полях, отражающих количественные характеристики (только поля над чертой)
После устранения выбросов осталось записей: 86

### Оценка количества уникальных значений для номинативных параметров

Наблюдения:

* Количество уникальных значений малое - 2-5 в каждом из номинативных полей
* Пол учеников распределен примерно поровну
* 75% учащихся живут в городе
* 2/3 семей имеют >3 детей
* 88% полных семей
* Наиболее популярная работа - гос.служба ("другое" не учитываем, так как это может быть совокупностью множества других профессий)
* Основные критерии выбора школы - учебная программа и репутация; менее значимая - удаленность от дома
* 70% опекунов - женщины
* 85% занимаются доп.образованием
* 60% занимаются домашним доп.образованием
* Примерно поровну распределены платные/бесплатные занятия
* Примерно поровну распределены доп.внеучебные занятия
* 81% посещали дет.сад
* У 86% дома есть интернет
* 97% хотят получить высшее образование
* 2/3 состоят в романтических отношениях

Выводы:

1. Малое кол-во уникальных значений позволит использовать их все при оценке зависимости
1. Скорее всего, номинативные поля, у которых одно из значений доминирует над остальными (например, `higher`), будут бесполезны при построении модели
 
### Корреляционный анализ

Числовые поля:

* `age`
* `Medu`
* `Fedu`
* `traveltime`
* `studytime`
* `failures`
* `famrel`
* `freetime`
* `goout`
* `health`
* `absences`
* `score`

Наблюдения и выводы:

1. Среди числовых полей наиболее сильно коррелируют друг с другом поля `Medu` и `Fedu` (0.71). Одно из этих полей исключаем - `Fedu`. Остальные поля коррелируют между собой слабо, поэтому оставляем их.
2. Ещё два поля потенциально можно было бы считать коррелирующими друг с другом - `freetime` и `goout`, однако недостаточно для исключения - 0.37.
3. Очень странно, что поля, описывающие время - `traveltime`, `studytime`, `freetime`, `goout` - очень слабо коррелируют. С точки зрения здравого смысла логично ожидать высокой корреляции между ними. Возможно, на это повлияло то, что данные количественные параметры приведены к категориальным

Номинативные поля:

* `school`
* `sex`
* `address`
* `famsize`
* `Pstatus`
* `Mjob`
* `Fjob`
* `reason`
* `guardian`
* `schoolsup`
* `famsup`
* `paid`
* `activities`
* `nursery`
* `higher`
* `internet`
* `romantic`

Наблюдения и выводы:

1. Кол-во уникальных значений номинативных полей малое (2-5), поэтому рассматриваются все уникальные значения
2. Поля `Pstatus`, можно считать влияющими слабо на предсказываемый параметр - у них примерно одинаковая медиана и, хотя IQR может различаться, но различается только за счет большего разброса квантилей при сохранении медианного значения.
3. Поле `nursery` остаётся под вопросом, поскольку оно выглядит как слабо влияющее на предсказываемый параметр (медиана одинаковая для обоих значений), но если считать критерием именно попадание в группу риска, т.е. в нижнюю часть по успеваемости, то данное поле следует оставить, так как дети, не посещающие дет.сад, имеют существенно меньший разброс по полученным оценкам.
4. Аналогичная ситуация с полями `internet` и `higher`.
5. По итогам проведенного теста Стьюдента было определено три поля, которые могут иметь значение - `sex`, `address`, `schoolsup`

Итоговый список полей, которые гипотетически могут влиять на предсказываемую величину:

* `age`
* `Medu`
* `traveltime`
* `studytime`
* `failures`
* `famrel`
* `freetime`
* `goout`
* `health`
* `absences`
* `sex`
* `address`
* `schoolsup`

### Выводы относительно качества данных

1. В исходном наборе данных присутствовало значительное количество пропусков - было потеряно 75% исходных данных - с 395 до 97 записей
2. Для увеличения датасета, после определения списка значимых полей была проведена повторная загрузка исходного датасета с удалением незначимых полей и только после этого была проведена чистка от пропусков. За счёт этого размер датасета после чистки стал 260 записей - потеря относительно исходного датасета уменьшилась до 34%.